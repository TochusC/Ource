     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_init_gdtidt
     7 00000000                                 	EXTERN	_init_pic
     8 00000000                                 	EXTERN	_io_sti
     9 00000000                                 	EXTERN	_keyfifo
    10 00000000                                 	EXTERN	_fifo8_init
    11 00000000                                 	EXTERN	_mousefifo
    12 00000000                                 	EXTERN	_io_out8
    13 00000000                                 	EXTERN	_init_palette
    14 00000000                                 	EXTERN	_init_screen8
    15 00000000                                 	EXTERN	_init_mouse_cursor8
    16 00000000                                 	EXTERN	_putblock8_8
    17 00000000                                 	EXTERN	_sprintf
    18 00000000                                 	EXTERN	_putfonts8_asc
    19 00000000                                 	EXTERN	_io_cli
    20 00000000                                 	EXTERN	_fifo8_status
    21 00000000                                 	EXTERN	_fifo8_get
    22 00000000                                 	EXTERN	_boxfill8
    23 00000000                                 	EXTERN	_io_stihlt
    24 00000000                                 	EXTERN	_io_in8
    25 00000000                                 [FILE "bootpack.c"]
    26                                          [SECTION .data]
    27 00000000                                 LC0:
    28 00000000 28 25 33 64 2C 20 25 33 64 29   	DB	"(%3d, %3d)",0x00
       0000000A 00 
    29 0000000B                                 LC1:
    30 0000000B 57 65 6C 63 6F 6D 65 20 74 6F   	DB	"Welcome to OURCE OS!",0x00
       00000015 20 4F 55 52 43 45 20 4F 53 21 
       0000001F 00 
    31 00000020                                 LC2:
    32 00000020 50 6F 77 65 72 65 64 20 62 79   	DB	"Powered by TochusC(UPC)",0x00
       0000002A 20 54 6F 63 68 75 73 43 28 55 
       00000034 50 43 29 00 
    33 00000038                                 LC4:
    34 00000038 5B 6C 63 72 20 25 34 64 20 25   	DB	"[lcr %4d %4d]",0x00
       00000042 34 64 5D 00 
    35 00000046                                 LC3:
    36 00000046 25 30 32 58 00                  	DB	"%02X",0x00
    37                                          [SECTION .text]
    38 00000000                                 	GLOBAL	_HariMain
    39 00000000                                 _HariMain:
    40 00000000 55                              	PUSH	EBP
    41 00000001 89 E5                           	MOV	EBP,ESP
    42 00000003 57                              	PUSH	EDI
    43 00000004 56                              	PUSH	ESI
    44 00000005 53                              	PUSH	EBX
    45 00000006 BB 00000002                     	MOV	EBX,2
    46 0000000B 81 EC 000001E4                  	SUB	ESP,484
    47 00000011 E8 [00000000]                   	CALL	_init_gdtidt
    48 00000016 E8 [00000000]                   	CALL	_init_pic
    49 0000001B E8 [00000000]                   	CALL	_io_sti
    50 00000020 8D 85 FFFFFEA4                  	LEA	EAX,DWORD [-348+EBP]
    51 00000026 50                              	PUSH	EAX
    52 00000027 6A 20                           	PUSH	32
    53 00000029 68 [00000000]                   	PUSH	_keyfifo
    54 0000002E E8 [00000000]                   	CALL	_fifo8_init
    55 00000033 8D 85 FFFFFE24                  	LEA	EAX,DWORD [-476+EBP]
    56 00000039 50                              	PUSH	EAX
    57 0000003A 68 00000080                     	PUSH	128
    58 0000003F 68 [00000000]                   	PUSH	_mousefifo
    59 00000044 E8 [00000000]                   	CALL	_fifo8_init
    60 00000049 68 000000F9                     	PUSH	249
    61 0000004E 6A 21                           	PUSH	33
    62 00000050 E8 [00000000]                   	CALL	_io_out8
    63 00000055 83 C4 20                        	ADD	ESP,32
    64 00000058 68 000000EF                     	PUSH	239
    65 0000005D 68 000000A1                     	PUSH	161
    66 00000062 E8 [00000000]                   	CALL	_io_out8
    67 00000067 E8 00000371                     	CALL	_init_keyboard
    68 0000006C E8 [00000000]                   	CALL	_init_palette
    69 00000071 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    70 00000078 50                              	PUSH	EAX
    71 00000079 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    72 00000080 50                              	PUSH	EAX
    73 00000081 FF 35 00000FF8                  	PUSH	DWORD [4088]
    74 00000087 E8 [00000000]                   	CALL	_init_screen8
    75 0000008C 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    76 00000093 8D 48 F0                        	LEA	ECX,DWORD [-16+EAX]
    77 00000096 89 C8                           	MOV	EAX,ECX
    78 00000098 99                              	CDQ
    79 00000099 F7 FB                           	IDIV	EBX
    80 0000009B 89 C7                           	MOV	EDI,EAX
    81 0000009D 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    82 000000A4 6A 0E                           	PUSH	14
    83 000000A6 8D 48 D4                        	LEA	ECX,DWORD [-44+EAX]
    84 000000A9 89 C8                           	MOV	EAX,ECX
    85 000000AB 99                              	CDQ
    86 000000AC F7 FB                           	IDIV	EBX
    87 000000AE 8D 9D FFFFFEC4                  	LEA	EBX,DWORD [-316+EBP]
    88 000000B4 89 C6                           	MOV	ESI,EAX
    89 000000B6 53                              	PUSH	EBX
    90 000000B7 E8 [00000000]                   	CALL	_init_mouse_cursor8
    91 000000BC 6A 10                           	PUSH	16
    92 000000BE 53                              	PUSH	EBX
    93 000000BF 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
    94 000000C2 56                              	PUSH	ESI
    95 000000C3 57                              	PUSH	EDI
    96 000000C4 6A 10                           	PUSH	16
    97 000000C6 6A 10                           	PUSH	16
    98 000000C8 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    99 000000CF 50                              	PUSH	EAX
   100 000000D0 FF 35 00000FF8                  	PUSH	DWORD [4088]
   101 000000D6 E8 [00000000]                   	CALL	_putblock8_8
   102 000000DB 83 C4 3C                        	ADD	ESP,60
   103 000000DE 56                              	PUSH	ESI
   104 000000DF 57                              	PUSH	EDI
   105 000000E0 68 [00000000]                   	PUSH	LC0
   106 000000E5 53                              	PUSH	EBX
   107 000000E6 E8 [00000000]                   	CALL	_sprintf
   108 000000EB 53                              	PUSH	EBX
   109 000000EC 6A 07                           	PUSH	7
   110 000000EE 6A 00                           	PUSH	0
   111 000000F0 6A 00                           	PUSH	0
   112 000000F2 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   113 000000F9 50                              	PUSH	EAX
   114 000000FA FF 35 00000FF8                  	PUSH	DWORD [4088]
   115 00000100 E8 [00000000]                   	CALL	_putfonts8_asc
   116 00000105 83 C4 28                        	ADD	ESP,40
   117 00000108 68 [0000000B]                   	PUSH	LC1
   118 0000010D 6A 00                           	PUSH	0
   119 0000010F 6A 30                           	PUSH	48
   120 00000111 6A 30                           	PUSH	48
   121 00000113 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   122 0000011A 50                              	PUSH	EAX
   123 0000011B FF 35 00000FF8                  	PUSH	DWORD [4088]
   124 00000121 E8 [00000000]                   	CALL	_putfonts8_asc
   125 00000126 68 [0000000B]                   	PUSH	LC1
   126 0000012B 6A 07                           	PUSH	7
   127 0000012D 6A 31                           	PUSH	49
   128 0000012F 6A 31                           	PUSH	49
   129 00000131 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   130 00000138 50                              	PUSH	EAX
   131 00000139 FF 35 00000FF8                  	PUSH	DWORD [4088]
   132 0000013F E8 [00000000]                   	CALL	_putfonts8_asc
   133 00000144 83 C4 30                        	ADD	ESP,48
   134 00000147 68 [00000020]                   	PUSH	LC2
   135 0000014C 6A 00                           	PUSH	0
   136 0000014E 6A 78                           	PUSH	120
   137 00000150 6A 78                           	PUSH	120
   138 00000152 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   139 00000159 50                              	PUSH	EAX
   140 0000015A FF 35 00000FF8                  	PUSH	DWORD [4088]
   141 00000160 E8 [00000000]                   	CALL	_putfonts8_asc
   142 00000165 68 [00000020]                   	PUSH	LC2
   143 0000016A 6A 07                           	PUSH	7
   144 0000016C 6A 78                           	PUSH	120
   145 0000016E 6A 78                           	PUSH	120
   146 00000170 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   147 00000177 50                              	PUSH	EAX
   148 00000178 FF 35 00000FF8                  	PUSH	DWORD [4088]
   149 0000017E E8 [00000000]                   	CALL	_putfonts8_asc
   150 00000183 8D 85 FFFFFE14                  	LEA	EAX,DWORD [-492+EBP]
   151 00000189 83 C4 30                        	ADD	ESP,48
   152 0000018C 50                              	PUSH	EAX
   153 0000018D E8 0000026C                     	CALL	_enable_mouse
   154 00000192 59                              	POP	ECX
   155 00000193                                 L2:
   156 00000193 E8 [00000000]                   	CALL	_io_cli
   157 00000198 68 [00000000]                   	PUSH	_keyfifo
   158 0000019D E8 [00000000]                   	CALL	_fifo8_status
   159 000001A2 68 [00000000]                   	PUSH	_mousefifo
   160 000001A7 89 C3                           	MOV	EBX,EAX
   161 000001A9 E8 [00000000]                   	CALL	_fifo8_status
   162 000001AE 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   163 000001B1 5B                              	POP	EBX
   164 000001B2 5A                              	POP	EDX
   165 000001B3 85 C0                           	TEST	EAX,EAX
   166 000001B5 0F 84 00000206                  	JE	L18
   167 000001BB 68 [00000000]                   	PUSH	_keyfifo
   168 000001C0 E8 [00000000]                   	CALL	_fifo8_status
   169 000001C5 59                              	POP	ECX
   170 000001C6 85 C0                           	TEST	EAX,EAX
   171 000001C8 0F 85 00000191                  	JNE	L19
   172 000001CE 68 [00000000]                   	PUSH	_mousefifo
   173 000001D3 E8 [00000000]                   	CALL	_fifo8_status
   174 000001D8 5A                              	POP	EDX
   175 000001D9 85 C0                           	TEST	EAX,EAX
   176 000001DB 74 B6                           	JE	L2
   177 000001DD 68 [00000000]                   	PUSH	_mousefifo
   178 000001E2 E8 [00000000]                   	CALL	_fifo8_get
   179 000001E7 89 C3                           	MOV	EBX,EAX
   180 000001E9 E8 [00000000]                   	CALL	_io_sti
   181 000001EE 0F B6 C3                        	MOVZX	EAX,BL
   182 000001F1 50                              	PUSH	EAX
   183 000001F2 8D 85 FFFFFE14                  	LEA	EAX,DWORD [-492+EBP]
   184 000001F8 50                              	PUSH	EAX
   185 000001F9 E8 0000022E                     	CALL	_mouse_decode
   186 000001FE 83 C4 0C                        	ADD	ESP,12
   187 00000201 85 C0                           	TEST	EAX,EAX
   188 00000203 74 8E                           	JE	L2
   189 00000205 FF B5 FFFFFE1C                  	PUSH	DWORD [-484+EBP]
   190 0000020B FF B5 FFFFFE18                  	PUSH	DWORD [-488+EBP]
   191 00000211 68 [00000038]                   	PUSH	LC4
   192 00000216 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
   193 00000219 53                              	PUSH	EBX
   194 0000021A E8 [00000000]                   	CALL	_sprintf
   195 0000021F 83 C4 10                        	ADD	ESP,16
   196 00000222 8B 85 FFFFFE20                  	MOV	EAX,DWORD [-480+EBP]
   197 00000228 A9 00000001                     	TEST	EAX,1
   198 0000022D 74 04                           	JE	L11
   199 0000022F C6 45 C5 4C                     	MOV	BYTE [-59+EBP],76
   200 00000233                                 L11:
   201 00000233 A9 00000002                     	TEST	EAX,2
   202 00000238 74 04                           	JE	L12
   203 0000023A C6 45 C7 52                     	MOV	BYTE [-57+EBP],82
   204 0000023E                                 L12:
   205 0000023E 83 E0 04                        	AND	EAX,4
   206 00000241 74 04                           	JE	L13
   207 00000243 C6 45 C6 43                     	MOV	BYTE [-58+EBP],67
   208 00000247                                 L13:
   209 00000247 6A 1F                           	PUSH	31
   210 00000249 68 00000097                     	PUSH	151
   211 0000024E 6A 10                           	PUSH	16
   212 00000250 6A 20                           	PUSH	32
   213 00000252 6A 0E                           	PUSH	14
   214 00000254 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   215 0000025B 50                              	PUSH	EAX
   216 0000025C FF 35 00000FF8                  	PUSH	DWORD [4088]
   217 00000262 E8 [00000000]                   	CALL	_boxfill8
   218 00000267 53                              	PUSH	EBX
   219 00000268 6A 07                           	PUSH	7
   220 0000026A 6A 10                           	PUSH	16
   221 0000026C 6A 20                           	PUSH	32
   222 0000026E 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   223 00000275 50                              	PUSH	EAX
   224 00000276 FF 35 00000FF8                  	PUSH	DWORD [4088]
   225 0000027C E8 [00000000]                   	CALL	_putfonts8_asc
   226 00000281 8D 46 0F                        	LEA	EAX,DWORD [15+ESI]
   227 00000284 83 C4 34                        	ADD	ESP,52
   228 00000287 50                              	PUSH	EAX
   229 00000288 8D 47 0F                        	LEA	EAX,DWORD [15+EDI]
   230 0000028B 50                              	PUSH	EAX
   231 0000028C 56                              	PUSH	ESI
   232 0000028D 57                              	PUSH	EDI
   233 0000028E 6A 0E                           	PUSH	14
   234 00000290 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   235 00000297 50                              	PUSH	EAX
   236 00000298 FF 35 00000FF8                  	PUSH	DWORD [4088]
   237 0000029E E8 [00000000]                   	CALL	_boxfill8
   238 000002A3 83 C4 1C                        	ADD	ESP,28
   239 000002A6 03 B5 FFFFFE1C                  	ADD	ESI,DWORD [-484+EBP]
   240 000002AC 03 BD FFFFFE18                  	ADD	EDI,DWORD [-488+EBP]
   241 000002B2 0F 88 000000A0                  	JS	L20
   242 000002B8                                 L14:
   243 000002B8 85 F6                           	TEST	ESI,ESI
   244 000002BA 0F 88 00000091                  	JS	L21
   245 000002C0                                 L15:
   246 000002C0 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   247 000002C7 83 E8 10                        	SUB	EAX,16
   248 000002CA 39 C7                           	CMP	EDI,EAX
   249 000002CC 7E 02                           	JLE	L16
   250 000002CE 89 C7                           	MOV	EDI,EAX
   251 000002D0                                 L16:
   252 000002D0 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
   253 000002D7 83 E8 10                        	SUB	EAX,16
   254 000002DA 39 C6                           	CMP	ESI,EAX
   255 000002DC 7E 02                           	JLE	L17
   256 000002DE 89 C6                           	MOV	ESI,EAX
   257 000002E0                                 L17:
   258 000002E0 56                              	PUSH	ESI
   259 000002E1 57                              	PUSH	EDI
   260 000002E2 68 [00000000]                   	PUSH	LC0
   261 000002E7 53                              	PUSH	EBX
   262 000002E8 E8 [00000000]                   	CALL	_sprintf
   263 000002ED 6A 0F                           	PUSH	15
   264 000002EF 6A 4F                           	PUSH	79
   265 000002F1 6A 00                           	PUSH	0
   266 000002F3 6A 00                           	PUSH	0
   267 000002F5 6A 0E                           	PUSH	14
   268 000002F7 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   269 000002FE 50                              	PUSH	EAX
   270 000002FF FF 35 00000FF8                  	PUSH	DWORD [4088]
   271 00000305 E8 [00000000]                   	CALL	_boxfill8
   272 0000030A 83 C4 2C                        	ADD	ESP,44
   273 0000030D 53                              	PUSH	EBX
   274 0000030E 6A 07                           	PUSH	7
   275 00000310 6A 00                           	PUSH	0
   276 00000312 6A 00                           	PUSH	0
   277 00000314 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   278 0000031B 50                              	PUSH	EAX
   279 0000031C FF 35 00000FF8                  	PUSH	DWORD [4088]
   280 00000322 E8 [00000000]                   	CALL	_putfonts8_asc
   281 00000327 8D 85 FFFFFEC4                  	LEA	EAX,DWORD [-316+EBP]
   282 0000032D 6A 10                           	PUSH	16
   283 0000032F 50                              	PUSH	EAX
   284 00000330 56                              	PUSH	ESI
   285 00000331 57                              	PUSH	EDI
   286 00000332 6A 10                           	PUSH	16
   287 00000334 6A 10                           	PUSH	16
   288 00000336 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   289 0000033D 50                              	PUSH	EAX
   290 0000033E FF 35 00000FF8                  	PUSH	DWORD [4088]
   291 00000344 E8 [00000000]                   	CALL	_putblock8_8
   292 00000349 83 C4 38                        	ADD	ESP,56
   293 0000034C E9 FFFFFE42                     	JMP	L2
   294 00000351                                 L21:
   295 00000351 31 F6                           	XOR	ESI,ESI
   296 00000353 E9 FFFFFF68                     	JMP	L15
   297 00000358                                 L20:
   298 00000358 31 FF                           	XOR	EDI,EDI
   299 0000035A E9 FFFFFF59                     	JMP	L14
   300 0000035F                                 L19:
   301 0000035F 68 [00000000]                   	PUSH	_keyfifo
   302 00000364 E8 [00000000]                   	CALL	_fifo8_get
   303 00000369 89 C3                           	MOV	EBX,EAX
   304 0000036B E8 [00000000]                   	CALL	_io_sti
   305 00000370 53                              	PUSH	EBX
   306 00000371 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
   307 00000374 68 [00000046]                   	PUSH	LC3
   308 00000379 53                              	PUSH	EBX
   309 0000037A E8 [00000000]                   	CALL	_sprintf
   310 0000037F 6A 1F                           	PUSH	31
   311 00000381 6A 0F                           	PUSH	15
   312 00000383 6A 10                           	PUSH	16
   313 00000385 6A 00                           	PUSH	0
   314 00000387 6A 0E                           	PUSH	14
   315 00000389 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   316 00000390 50                              	PUSH	EAX
   317 00000391 FF 35 00000FF8                  	PUSH	DWORD [4088]
   318 00000397 E8 [00000000]                   	CALL	_boxfill8
   319 0000039C 83 C4 2C                        	ADD	ESP,44
   320 0000039F 53                              	PUSH	EBX
   321 000003A0 6A 07                           	PUSH	7
   322 000003A2 6A 10                           	PUSH	16
   323 000003A4 6A 00                           	PUSH	0
   324 000003A6 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   325 000003AD 50                              	PUSH	EAX
   326 000003AE FF 35 00000FF8                  	PUSH	DWORD [4088]
   327 000003B4 E8 [00000000]                   	CALL	_putfonts8_asc
   328 000003B9 83 C4 18                        	ADD	ESP,24
   329 000003BC E9 FFFFFDD2                     	JMP	L2
   330 000003C1                                 L18:
   331 000003C1 E8 [00000000]                   	CALL	_io_stihlt
   332 000003C6 E9 FFFFFDC8                     	JMP	L2
   333 000003CB                                 	GLOBAL	_wait_KBC_sendready
   334 000003CB                                 _wait_KBC_sendready:
   335 000003CB 55                              	PUSH	EBP
   336 000003CC 89 E5                           	MOV	EBP,ESP
   337 000003CE                                 L23:
   338 000003CE 6A 64                           	PUSH	100
   339 000003D0 E8 [00000000]                   	CALL	_io_in8
   340 000003D5 5A                              	POP	EDX
   341 000003D6 83 E0 02                        	AND	EAX,2
   342 000003D9 75 F3                           	JNE	L23
   343 000003DB C9                              	LEAVE
   344 000003DC C3                              	RET
   345 000003DD                                 	GLOBAL	_init_keyboard
   346 000003DD                                 _init_keyboard:
   347 000003DD 55                              	PUSH	EBP
   348 000003DE 89 E5                           	MOV	EBP,ESP
   349 000003E0 E8 FFFFFFE6                     	CALL	_wait_KBC_sendready
   350 000003E5 6A 60                           	PUSH	96
   351 000003E7 6A 64                           	PUSH	100
   352 000003E9 E8 [00000000]                   	CALL	_io_out8
   353 000003EE E8 FFFFFFD8                     	CALL	_wait_KBC_sendready
   354 000003F3 6A 47                           	PUSH	71
   355 000003F5 6A 60                           	PUSH	96
   356 000003F7 E8 [00000000]                   	CALL	_io_out8
   357 000003FC C9                              	LEAVE
   358 000003FD C3                              	RET
   359 000003FE                                 	GLOBAL	_enable_mouse
   360 000003FE                                 _enable_mouse:
   361 000003FE 55                              	PUSH	EBP
   362 000003FF 89 E5                           	MOV	EBP,ESP
   363 00000401 E8 FFFFFFC5                     	CALL	_wait_KBC_sendready
   364 00000406 68 000000D4                     	PUSH	212
   365 0000040B 6A 64                           	PUSH	100
   366 0000040D E8 [00000000]                   	CALL	_io_out8
   367 00000412 E8 FFFFFFB4                     	CALL	_wait_KBC_sendready
   368 00000417 68 000000F4                     	PUSH	244
   369 0000041C 6A 60                           	PUSH	96
   370 0000041E E8 [00000000]                   	CALL	_io_out8
   371 00000423 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   372 00000426 C6 40 03 00                     	MOV	BYTE [3+EAX],0
   373 0000042A C9                              	LEAVE
   374 0000042B C3                              	RET
   375 0000042C                                 	GLOBAL	_mouse_decode
   376 0000042C                                 _mouse_decode:
   377 0000042C 55                              	PUSH	EBP
   378 0000042D 89 E5                           	MOV	EBP,ESP
   379 0000042F 56                              	PUSH	ESI
   380 00000430 53                              	PUSH	EBX
   381 00000431 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   382 00000434 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   383 00000437 89 CE                           	MOV	ESI,ECX
   384 00000439 8A 42 03                        	MOV	AL,BYTE [3+EDX]
   385 0000043C 84 C0                           	TEST	AL,AL
   386 0000043E 75 11                           	JNE	L30
   387 00000440 80 F9 FA                        	CMP	CL,-6
   388 00000443 74 06                           	JE	L39
   389 00000445                                 L38:
   390 00000445 31 C0                           	XOR	EAX,EAX
   391 00000447                                 L29:
   392 00000447 5B                              	POP	EBX
   393 00000448 5E                              	POP	ESI
   394 00000449 5D                              	POP	EBP
   395 0000044A C3                              	RET
   396 0000044B                                 L39:
   397 0000044B C6 42 03 01                     	MOV	BYTE [3+EDX],1
   398 0000044F EB F4                           	JMP	L38
   399 00000451                                 L30:
   400 00000451 3C 01                           	CMP	AL,1
   401 00000453 74 61                           	JE	L40
   402 00000455 3C 02                           	CMP	AL,2
   403 00000457 74 54                           	JE	L41
   404 00000459 3C 03                           	CMP	AL,3
   405 0000045B 74 05                           	JE	L42
   406 0000045D 83 C8 FF                        	OR	EAX,-1
   407 00000460 EB E5                           	JMP	L29
   408 00000462                                 L42:
   409 00000462 8A 1A                           	MOV	BL,BYTE [EDX]
   410 00000464 81 E6 000000FF                  	AND	ESI,255
   411 0000046A 89 D8                           	MOV	EAX,EBX
   412 0000046C 88 4A 02                        	MOV	BYTE [2+EDX],CL
   413 0000046F 83 E0 07                        	AND	EAX,7
   414 00000472 89 72 08                        	MOV	DWORD [8+EDX],ESI
   415 00000475 89 42 0C                        	MOV	DWORD [12+EDX],EAX
   416 00000478 88 D8                           	MOV	AL,BL
   417 0000047A 0F B6 4A 01                     	MOVZX	ECX,BYTE [1+EDX]
   418 0000047E 83 E0 10                        	AND	EAX,16
   419 00000481 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   420 00000484 C6 42 03 01                     	MOV	BYTE [3+EDX],1
   421 00000488 84 C0                           	TEST	AL,AL
   422 0000048A 74 09                           	JE	L36
   423 0000048C 81 C9 FFFFFF00                  	OR	ECX,-256
   424 00000492 89 4A 04                        	MOV	DWORD [4+EDX],ECX
   425 00000495                                 L36:
   426 00000495 83 E3 20                        	AND	EBX,32
   427 00000498 84 DB                           	TEST	BL,BL
   428 0000049A 74 07                           	JE	L37
   429 0000049C 81 4A 08 FFFFFF00               	OR	DWORD [8+EDX],-256
   430 000004A3                                 L37:
   431 000004A3 F7 5A 08                        	NEG	DWORD [8+EDX]
   432 000004A6 B8 00000001                     	MOV	EAX,1
   433 000004AB EB 9A                           	JMP	L29
   434 000004AD                                 L41:
   435 000004AD 88 4A 01                        	MOV	BYTE [1+EDX],CL
   436 000004B0 C6 42 03 03                     	MOV	BYTE [3+EDX],3
   437 000004B4 EB 8F                           	JMP	L38
   438 000004B6                                 L40:
   439 000004B6 83 E6 C8                        	AND	ESI,-56
   440 000004B9 89 F0                           	MOV	EAX,ESI
   441 000004BB 3C 08                           	CMP	AL,8
   442 000004BD 75 86                           	JNE	L38
   443 000004BF 88 0A                           	MOV	BYTE [EDX],CL
   444 000004C1 C6 42 03 02                     	MOV	BYTE [3+EDX],2
   445 000004C5 E9 FFFFFF7B                     	JMP	L38
